<?php/** * Title: WP eCommerce IDeal Addon * Description:  * Copyright: Copyright (c) 2005 - 2011 * Company: Pronamic * @author Remco Tolsma * @version 1.0 */class Pronamic_WPeCommerce_IDeal_AddOn {	/**	 * Slug	 * 	 * @var string	 */	const SLUG = 'wp-e-commerce';	//////////////////////////////////////////////////		/**	 * Bootstrap	 */	public static function bootstrap(){		// Add gateway to gateways		add_filter('wpsc_merchants_modules', array(__CLASS__, 'merchantModules'));				// Update payment status when returned from iDeal		add_action('pronamic_ideal_status_update', array(__CLASS__, 'updateStatus'));				// Source Column		add_filter('pronamic_ideal_source_column_wp-e-commerce', array(__CLASS__, 'sourceColumn'), 10, 2);	}	//////////////////////////////////////////////////		/**	 * Add gateway	 */	public static function merchantModules($gateways) {		$gateways[] = array(			'name' => __('Pronamic iDEAL', 'pronamic-ideal') ,			'api_version' => 2.0 , 			'image' => plugins_url('', __FILE__) . '/ideal.png' , 			'class_name' => 'Pronamic_WPeCommerce_IDeal_IDealMerchant' , 			'has_recurring_billing' => false , 			'wp_admin_cannot_cancel' => false , 			'display_name' => __('iDEAL', Pronamic_WordPress_IDeal_Plugin::TEXT_DOMAIN) , 			'requirements' => array(				'php_version' => 5.0 , 				'extra_modules' => array() 			) ,			'form' => 'pronamic_ideal_wpsc_merchant_form' , 			'submit_function' => 'pronamic_ideal_wpsc_merchant_submit_function' , 			// this may be legacy, not yet decided			'internalname' => 'wpsc_merchant_pronamic_ideal'		);		return $gateways;	}		//////////////////////////////////////////////////	/**	 * Update lead status of the specified payment	 * 	 * @param string $payment	 */	public static function updateStatus($payment) {		// @todo	}	//////////////////////////////////////////////////		/**	 * Source column	 */	public static function sourceColumn($text, $payment) {		$text  = '';		$text .= __('WP e-Commerce', Pronamic_WordPress_IDeal_Plugin::TEXT_DOMAIN) . '<br />';		$text .= sprintf('<a href="%s">', add_query_arg(array('page' => 'wpsc-sales-logs', 'purchaselog_id' => $payment->getSourceId()), admin_url('index.php')));		$text .= sprintf(__('Purchase #%s', Pronamic_WordPress_IDeal_Plugin::TEXT_DOMAIN), $payment->getSourceId());		$text .= '</a>';		return $text;	}}